<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lección 16 Regresión lineal | Bioestadística (Medicina UIB)</title>
  <meta name="description" content="Apunts Bioestadística per a Medicina bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="Lección 16 Regresión lineal | Bioestadística (Medicina UIB)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Apunts Bioestadística per a Medicina bookdown::gitbook." />
  <meta name="github-repo" content="AprendeR-UIB/INREMDN" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lección 16 Regresión lineal | Bioestadística (Medicina UIB)" />
  
  <meta name="twitter:description" content="Apunts Bioestadística per a Medicina bookdown::gitbook." />
  

<meta name="author" content="Irene García, Francesc Rosselló" />


<meta name="date" content="2024-04-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="qué-test-usar.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">INREMDN</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Presentación</a></li>
<li class="part"><span><b>Tema I: Introducción a los estudios médicos y la estadística</b></span></li>
<li class="chapter" data-level="1" data-path="introducción.html"><a href="introducción.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="estudios-médicos.html"><a href="estudios-médicos.html"><i class="fa fa-check"></i><b>2</b> Estudios médicos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="estudios-médicos.html"><a href="estudios-médicos.html#sec:pasos"><i class="fa fa-check"></i><b>2.1</b> Pasos de un estudio médico</a></li>
<li class="chapter" data-level="2.2" data-path="estudios-médicos.html"><a href="estudios-médicos.html#algunos-calificativos-para-los-estudios-médicos"><i class="fa fa-check"></i><b>2.2</b> Algunos calificativos para los estudios médicos</a></li>
<li class="chapter" data-level="2.3" data-path="estudios-médicos.html"><a href="estudios-médicos.html#estudios-descriptivos"><i class="fa fa-check"></i><b>2.3</b> Estudios descriptivos</a></li>
<li class="chapter" data-level="2.4" data-path="estudios-médicos.html"><a href="estudios-médicos.html#sec:cyc"><i class="fa fa-check"></i><b>2.4</b> Estudios de casos y controles</a></li>
<li class="chapter" data-level="2.5" data-path="estudios-médicos.html"><a href="estudios-médicos.html#estudios-de-cohorte"><i class="fa fa-check"></i><b>2.5</b> Estudios de cohorte</a></li>
<li class="chapter" data-level="2.6" data-path="estudios-médicos.html"><a href="estudios-médicos.html#estudios-transversales"><i class="fa fa-check"></i><b>2.6</b> Estudios transversales</a></li>
<li class="chapter" data-level="2.7" data-path="estudios-médicos.html"><a href="estudios-médicos.html#sec:ecol"><i class="fa fa-check"></i><b>2.7</b> Estudios ecológicos</a></li>
<li class="chapter" data-level="2.8" data-path="estudios-médicos.html"><a href="estudios-médicos.html#ensayos-clínicos"><i class="fa fa-check"></i><b>2.8</b> Ensayos clínicos</a></li>
<li class="chapter" data-level="2.9" data-path="estudios-médicos.html"><a href="estudios-médicos.html#a-modo-de-resumen"><i class="fa fa-check"></i><b>2.9</b> A modo de resumen</a></li>
<li class="chapter" data-level="2.10" data-path="estudios-médicos.html"><a href="estudios-médicos.html#revisiones-sistemáticas-y-metaanálisis"><i class="fa fa-check"></i><b>2.10</b> Revisiones sistemáticas y metaanálisis</a></li>
<li class="chapter" data-level="2.11" data-path="estudios-médicos.html"><a href="estudios-médicos.html#sec:causalidad"><i class="fa fa-check"></i><b>2.11</b> (Bonus track) Unos criterios de causalidad</a></li>
<li class="chapter" data-level="2.12" data-path="estudios-médicos.html"><a href="estudios-médicos.html#bonus-track-preguntas-clínicas-en-formato-pico"><i class="fa fa-check"></i><b>2.12</b> (Bonus track) Preguntas clínicas en formato PICO</a></li>
<li class="chapter" data-level="2.13" data-path="estudios-médicos.html"><a href="estudios-médicos.html#test"><i class="fa fa-check"></i><b>2.13</b> Test</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="algunos-conceptos-básicos-más.html"><a href="algunos-conceptos-básicos-más.html"><i class="fa fa-check"></i><b>3</b> Algunos conceptos básicos más</a>
<ul>
<li class="chapter" data-level="3.1" data-path="algunos-conceptos-básicos-más.html"><a href="algunos-conceptos-básicos-más.html#unidad-de-observación"><i class="fa fa-check"></i><b>3.1</b> Unidad de observación</a></li>
<li class="chapter" data-level="3.2" data-path="algunos-conceptos-básicos-más.html"><a href="algunos-conceptos-básicos-más.html#población-y-muestra"><i class="fa fa-check"></i><b>3.2</b> Población y muestra</a></li>
<li class="chapter" data-level="3.3" data-path="algunos-conceptos-básicos-más.html"><a href="algunos-conceptos-básicos-más.html#sec:muestreo"><i class="fa fa-check"></i><b>3.3</b> Tipos básicos de muestreo</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="algunos-conceptos-básicos-más.html"><a href="algunos-conceptos-básicos-más.html#sec:mas"><i class="fa fa-check"></i><b>3.3.1</b> Muestreo aleatorio con y sin reposición</a></li>
<li class="chapter" data-level="3.3.2" data-path="algunos-conceptos-básicos-más.html"><a href="algunos-conceptos-básicos-más.html#sec:sist"><i class="fa fa-check"></i><b>3.3.2</b> Muestreo sistemático</a></li>
<li class="chapter" data-level="3.3.3" data-path="algunos-conceptos-básicos-más.html"><a href="algunos-conceptos-básicos-más.html#sec:estr"><i class="fa fa-check"></i><b>3.3.3</b> Muestreo aleatorio estratificado</a></li>
<li class="chapter" data-level="3.3.4" data-path="algunos-conceptos-básicos-más.html"><a href="algunos-conceptos-básicos-más.html#sec:mcluster"><i class="fa fa-check"></i><b>3.3.4</b> Muestreo por conglomerados</a></li>
<li class="chapter" data-level="3.3.5" data-path="algunos-conceptos-básicos-más.html"><a href="algunos-conceptos-básicos-más.html#sec:oport"><i class="fa fa-check"></i><b>3.3.5</b> Muestreos no aleatorios</a></li>
<li class="chapter" data-level="3.3.6" data-path="algunos-conceptos-básicos-más.html"><a href="algunos-conceptos-básicos-más.html#sec:poli"><i class="fa fa-check"></i><b>3.3.6</b> Muestreo polietápico</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="algunos-conceptos-básicos-más.html"><a href="algunos-conceptos-básicos-más.html#sec:sesgos"><i class="fa fa-check"></i><b>3.4</b> Sesgos</a></li>
<li class="chapter" data-level="3.5" data-path="algunos-conceptos-básicos-más.html"><a href="algunos-conceptos-básicos-más.html#test-1"><i class="fa fa-check"></i><b>3.5</b> Test</a></li>
</ul></li>
<li class="part"><span><b>Tema II: Probabilidades</b></span></li>
<li class="chapter" data-level="4" data-path="probabilidades-elementales-las-mates.html"><a href="probabilidades-elementales-las-mates.html"><i class="fa fa-check"></i><b>4</b> Probabilidades elementales: Las mates</a>
<ul>
<li class="chapter" data-level="4.1" data-path="probabilidades-elementales-las-mates.html"><a href="probabilidades-elementales-las-mates.html#álgebra-de-conjuntos"><i class="fa fa-check"></i><b>4.1</b> Álgebra de conjuntos</a></li>
<li class="chapter" data-level="4.2" data-path="probabilidades-elementales-las-mates.html"><a href="probabilidades-elementales-las-mates.html#algunas-fórmulas-básicas"><i class="fa fa-check"></i><b>4.2</b> Algunas fórmulas básicas</a></li>
<li class="chapter" data-level="4.3" data-path="probabilidades-elementales-las-mates.html"><a href="probabilidades-elementales-las-mates.html#sec:odds"><i class="fa fa-check"></i><b>4.3</b> Odds</a></li>
<li class="chapter" data-level="4.4" data-path="probabilidades-elementales-las-mates.html"><a href="probabilidades-elementales-las-mates.html#probabilidad-condicionada"><i class="fa fa-check"></i><b>4.4</b> Probabilidad condicionada</a></li>
<li class="chapter" data-level="4.5" data-path="probabilidades-elementales-las-mates.html"><a href="probabilidades-elementales-las-mates.html#sucesos-independientes"><i class="fa fa-check"></i><b>4.5</b> Sucesos independientes</a></li>
<li class="chapter" data-level="4.6" data-path="probabilidades-elementales-las-mates.html"><a href="probabilidades-elementales-las-mates.html#odds-condicionadas-y-odds-ratios-relativas"><i class="fa fa-check"></i><b>4.6</b> Odds condicionadas y odds ratios relativas</a></li>
<li class="chapter" data-level="4.7" data-path="probabilidades-elementales-las-mates.html"><a href="probabilidades-elementales-las-mates.html#el-teorema-de-la-probabilidad-total"><i class="fa fa-check"></i><b>4.7</b> El teorema de la probabilidad total</a></li>
<li class="chapter" data-level="4.8" data-path="probabilidades-elementales-las-mates.html"><a href="probabilidades-elementales-las-mates.html#la-fórmula-de-bayes"><i class="fa fa-check"></i><b>4.8</b> La fórmula de Bayes</a></li>
<li class="chapter" data-level="4.9" data-path="probabilidades-elementales-las-mates.html"><a href="probabilidades-elementales-las-mates.html#test-2"><i class="fa fa-check"></i><b>4.9</b> Test</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="probabilidades-elementales-aplicaciones-en-medicina.html"><a href="probabilidades-elementales-aplicaciones-en-medicina.html"><i class="fa fa-check"></i><b>5</b> Probabilidades elementales: Aplicaciones en medicina</a>
<ul>
<li class="chapter" data-level="5.1" data-path="probabilidades-elementales-aplicaciones-en-medicina.html"><a href="probabilidades-elementales-aplicaciones-en-medicina.html#pruebas-diagnósticas"><i class="fa fa-check"></i><b>5.1</b> Pruebas diagnósticas</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="probabilidades-elementales-aplicaciones-en-medicina.html"><a href="probabilidades-elementales-aplicaciones-en-medicina.html#sensibilidad-especificidad-valores-predictivos-etc."><i class="fa fa-check"></i><b>5.1.1</b> Sensibilidad, especificidad, valores predictivos etc.</a></li>
<li class="chapter" data-level="5.1.2" data-path="probabilidades-elementales-aplicaciones-en-medicina.html"><a href="probabilidades-elementales-aplicaciones-en-medicina.html#curvas-roc"><i class="fa fa-check"></i><b>5.1.2</b> Curvas ROC</a></li>
<li class="chapter" data-level="5.1.3" data-path="probabilidades-elementales-aplicaciones-en-medicina.html"><a href="probabilidades-elementales-aplicaciones-en-medicina.html#con-jamovi"><i class="fa fa-check"></i><b>5.1.3</b> Con JAMOVI</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="probabilidades-elementales-aplicaciones-en-medicina.html"><a href="probabilidades-elementales-aplicaciones-en-medicina.html#sec:probaplic2"><i class="fa fa-check"></i><b>5.2</b> Riesgos</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="probabilidades-elementales-aplicaciones-en-medicina.html"><a href="probabilidades-elementales-aplicaciones-en-medicina.html#sec:riesgosRR"><i class="fa fa-check"></i><b>5.2.1</b> Riesgos relativos y absolutos</a></li>
<li class="chapter" data-level="5.2.2" data-path="probabilidades-elementales-aplicaciones-en-medicina.html"><a href="probabilidades-elementales-aplicaciones-en-medicina.html#sec:riesgosCyC"><i class="fa fa-check"></i><b>5.2.2</b> <em>Odds ratios</em></a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="probabilidades-elementales-aplicaciones-en-medicina.html"><a href="probabilidades-elementales-aplicaciones-en-medicina.html#tratamientos"><i class="fa fa-check"></i><b>5.3</b> Tratamientos</a></li>
<li class="chapter" data-level="5.4" data-path="probabilidades-elementales-aplicaciones-en-medicina.html"><a href="probabilidades-elementales-aplicaciones-en-medicina.html#test-3"><i class="fa fa-check"></i><b>5.4</b> Test</a></li>
</ul></li>
<li class="part"><span><b>Tema III: Estadística descriptiva</b></span></li>
<li class="chapter" data-level="6" data-path="sec:tiposdatos.html"><a href="sec:tiposdatos.html"><i class="fa fa-check"></i><b>6</b> Tipos de datos</a>
<ul>
<li class="chapter" data-level="6.1" data-path="sec:tiposdatos.html"><a href="sec:tiposdatos.html#test-4"><i class="fa fa-check"></i><b>6.1</b> Test</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="descripción-de-datos-cualitativos.html"><a href="descripción-de-datos-cualitativos.html"><i class="fa fa-check"></i><b>7</b> Descripción de datos cualitativos</a>
<ul>
<li class="chapter" data-level="7.1" data-path="descripción-de-datos-cualitativos.html"><a href="descripción-de-datos-cualitativos.html#sec:frecs"><i class="fa fa-check"></i><b>7.1</b> Frecuencias</a></li>
<li class="chapter" data-level="7.2" data-path="descripción-de-datos-cualitativos.html"><a href="descripción-de-datos-cualitativos.html#gráficos"><i class="fa fa-check"></i><b>7.2</b> Gráficos</a></li>
<li class="chapter" data-level="7.3" data-path="descripción-de-datos-cualitativos.html"><a href="descripción-de-datos-cualitativos.html#tablas-de-frecuencias-multidimensionales"><i class="fa fa-check"></i><b>7.3</b> Tablas de frecuencias multidimensionales</a></li>
<li class="chapter" data-level="7.4" data-path="descripción-de-datos-cualitativos.html"><a href="descripción-de-datos-cualitativos.html#sec:barrasbidim"><i class="fa fa-check"></i><b>7.4</b> Diagramas de barras bidimensionales</a></li>
<li class="chapter" data-level="7.5" data-path="descripción-de-datos-cualitativos.html"><a href="descripción-de-datos-cualitativos.html#diagramas-de-mosaico"><i class="fa fa-check"></i><b>7.5</b> Diagramas de mosaico</a></li>
<li class="chapter" data-level="7.6" data-path="descripción-de-datos-cualitativos.html"><a href="descripción-de-datos-cualitativos.html#test-5"><i class="fa fa-check"></i><b>7.6</b> Test</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="descripción-de-datos-ordinales.html"><a href="descripción-de-datos-ordinales.html"><i class="fa fa-check"></i><b>8</b> Descripción de datos ordinales</a>
<ul>
<li class="chapter" data-level="8.1" data-path="descripción-de-datos-ordinales.html"><a href="descripción-de-datos-ordinales.html#frecuencias-y-diagramas-de-barras"><i class="fa fa-check"></i><b>8.1</b> Frecuencias y diagramas de barras</a></li>
<li class="chapter" data-level="8.2" data-path="descripción-de-datos-ordinales.html"><a href="descripción-de-datos-ordinales.html#test-6"><i class="fa fa-check"></i><b>8.2</b> Test</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html"><i class="fa fa-check"></i><b>9</b> Descripción de datos cuantitativos</a>
<ul>
<li class="chapter" data-level="9.1" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#frecuencias"><i class="fa fa-check"></i><b>9.1</b> Frecuencias</a></li>
<li class="chapter" data-level="9.2" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#medidas-de-tendencia-central"><i class="fa fa-check"></i><b>9.2</b> Medidas de tendencia central</a></li>
<li class="chapter" data-level="9.3" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#medidas-de-posición"><i class="fa fa-check"></i><b>9.3</b> Medidas de posición</a></li>
<li class="chapter" data-level="9.4" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#medidas-de-dispersión"><i class="fa fa-check"></i><b>9.4</b> Medidas de dispersión</a></li>
<li class="chapter" data-level="9.5" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#diagramas-de-puntos-y-de-caja"><i class="fa fa-check"></i><b>9.5</b> Diagramas de puntos y de caja</a></li>
<li class="chapter" data-level="9.6" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#histogramas"><i class="fa fa-check"></i><b>9.6</b> Histogramas</a></li>
<li class="chapter" data-level="9.7" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#polígonos-de-frecuencias"><i class="fa fa-check"></i><b>9.7</b> Polígonos de frecuencias</a></li>
<li class="chapter" data-level="9.8" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#asimetría-y-curtosis"><i class="fa fa-check"></i><b>9.8</b> Asimetría y curtosis</a></li>
<li class="chapter" data-level="9.9" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#estadísticos-y-gráficos-con-jamovi"><i class="fa fa-check"></i><b>9.9</b> Estadísticos y gráficos con JAMOVI</a></li>
<li class="chapter" data-level="9.10" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#sec:estagrup"><i class="fa fa-check"></i><b>9.10</b> Estadísticos sobre datos agrupados</a></li>
<li class="chapter" data-level="9.11" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#sec:edbivar"><i class="fa fa-check"></i><b>9.11</b> Datos cuantitativos bivariantes</a></li>
<li class="chapter" data-level="9.12" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#gráficos-en-escala-logarítmica"><i class="fa fa-check"></i><b>9.12</b> Gráficos en escala logarítmica</a></li>
<li class="chapter" data-level="9.13" data-path="descripción-de-datos-cuantitativos.html"><a href="descripción-de-datos-cuantitativos.html#test-7"><i class="fa fa-check"></i><b>9.13</b> Test</a></li>
</ul></li>
<li class="part"><span><b>Tema IV: Variables aleatorias</b></span></li>
<li class="chapter" data-level="10" data-path="variables-aleatorias-discretas.html"><a href="variables-aleatorias-discretas.html"><i class="fa fa-check"></i><b>10</b> Variables aleatorias discretas</a>
<ul>
<li class="chapter" data-level="10.1" data-path="variables-aleatorias-discretas.html"><a href="variables-aleatorias-discretas.html#densidad-y-distribución"><i class="fa fa-check"></i><b>10.1</b> Densidad y distribución</a></li>
<li class="chapter" data-level="10.2" data-path="variables-aleatorias-discretas.html"><a href="variables-aleatorias-discretas.html#esperanza"><i class="fa fa-check"></i><b>10.2</b> Esperanza</a></li>
<li class="chapter" data-level="10.3" data-path="variables-aleatorias-discretas.html"><a href="variables-aleatorias-discretas.html#varianza-y-desviación-típica"><i class="fa fa-check"></i><b>10.3</b> Varianza y desviación típica</a></li>
<li class="chapter" data-level="10.4" data-path="variables-aleatorias-discretas.html"><a href="variables-aleatorias-discretas.html#cuantiles"><i class="fa fa-check"></i><b>10.4</b> Cuantiles</a></li>
<li class="chapter" data-level="10.5" data-path="variables-aleatorias-discretas.html"><a href="variables-aleatorias-discretas.html#familias-importantes-de-variables-aleatorias-discretas"><i class="fa fa-check"></i><b>10.5</b> Familias importantes de variables aleatorias discretas</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="variables-aleatorias-discretas.html"><a href="variables-aleatorias-discretas.html#variables-aleatorias-binomiales"><i class="fa fa-check"></i><b>10.5.1</b> Variables aleatorias binomiales</a></li>
<li class="chapter" data-level="10.5.2" data-path="variables-aleatorias-discretas.html"><a href="variables-aleatorias-discretas.html#variables-aleatorias-hipergeométricas"><i class="fa fa-check"></i><b>10.5.2</b> Variables aleatorias hipergeométricas</a></li>
<li class="chapter" data-level="10.5.3" data-path="variables-aleatorias-discretas.html"><a href="variables-aleatorias-discretas.html#variables-aleatorias-de-poisson"><i class="fa fa-check"></i><b>10.5.3</b> Variables aleatorias de Poisson</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="variables-aleatorias-discretas.html"><a href="variables-aleatorias-discretas.html#test-8"><i class="fa fa-check"></i><b>10.6</b> Test</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="variables-aleatorias-continuas.html"><a href="variables-aleatorias-continuas.html"><i class="fa fa-check"></i><b>11</b> Variables aleatorias continuas</a>
<ul>
<li class="chapter" data-level="11.1" data-path="variables-aleatorias-continuas.html"><a href="variables-aleatorias-continuas.html#densidad-y-distribución-1"><i class="fa fa-check"></i><b>11.1</b> Densidad y distribución</a></li>
<li class="chapter" data-level="11.2" data-path="variables-aleatorias-continuas.html"><a href="variables-aleatorias-continuas.html#esperanza-varianza-cuantiles"><i class="fa fa-check"></i><b>11.2</b> Esperanza, varianza, cuantiles…</a></li>
<li class="chapter" data-level="11.3" data-path="variables-aleatorias-continuas.html"><a href="variables-aleatorias-continuas.html#sec:normal"><i class="fa fa-check"></i><b>11.3</b> Variables aleatorias normales</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="variables-aleatorias-continuas.html"><a href="variables-aleatorias-continuas.html#propiedades-básicas"><i class="fa fa-check"></i><b>11.3.1</b> Propiedades básicas</a></li>
<li class="chapter" data-level="11.3.2" data-path="variables-aleatorias-continuas.html"><a href="variables-aleatorias-continuas.html#intervalos-de-referencia"><i class="fa fa-check"></i><b>11.3.2</b> Intervalos de referencia</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="variables-aleatorias-continuas.html"><a href="variables-aleatorias-continuas.html#test-9"><i class="fa fa-check"></i><b>11.4</b> Test</a></li>
</ul></li>
<li class="part"><span><b>Tema V: Estadística inferencial</b></span></li>
<li class="chapter" data-level="12" data-path="estimadores.html"><a href="estimadores.html"><i class="fa fa-check"></i><b>12</b> Estimadores</a>
<ul>
<li class="chapter" data-level="12.1" data-path="estimadores.html"><a href="estimadores.html#la-media-muestral"><i class="fa fa-check"></i><b>12.1</b> La media muestral</a></li>
<li class="chapter" data-level="12.2" data-path="estimadores.html"><a href="estimadores.html#la-proporción-muestral"><i class="fa fa-check"></i><b>12.2</b> La proporción muestral</a></li>
<li class="chapter" data-level="12.3" data-path="estimadores.html"><a href="estimadores.html#la-varianza-muestral"><i class="fa fa-check"></i><b>12.3</b> La varianza muestral</a></li>
<li class="chapter" data-level="12.4" data-path="estimadores.html"><a href="estimadores.html#la-distribución-t-de-student"><i class="fa fa-check"></i><b>12.4</b> La distribución t de Student</a></li>
<li class="chapter" data-level="12.5" data-path="estimadores.html"><a href="estimadores.html#test-10"><i class="fa fa-check"></i><b>12.5</b> Test</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html"><i class="fa fa-check"></i><b>13</b> Intervalos de confianza</a>
<ul>
<li class="chapter" data-level="13.1" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#sec:IC"><i class="fa fa-check"></i><b>13.1</b> Definiciones básicas</a></li>
<li class="chapter" data-level="13.2" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#un-ejemplo-ic-95-para-la-media-de-una-variable-aleatoria-normal"><i class="fa fa-check"></i><b>13.2</b> Un ejemplo: IC-95% para la media de una variable aleatoria normal</a></li>
<li class="chapter" data-level="13.3" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#intervalo-de-confianza-para-la-media-basado-en-la-t-de-student"><i class="fa fa-check"></i><b>13.3</b> Intervalo de confianza para la media basado en la t de Student</a></li>
<li class="chapter" data-level="13.4" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#intervalos-de-confianza-para-proporciones"><i class="fa fa-check"></i><b>13.4</b> Intervalos de confianza para proporciones</a></li>
<li class="chapter" data-level="13.5" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#bonus-track-otros-intervalos-de-confianza"><i class="fa fa-check"></i><b>13.5</b> (Bonus track) Otros intervalos de confianza</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#un-intervalo-de-confianza-para-la-diferencia-de-proporciones"><i class="fa fa-check"></i><b>13.5.1</b> Un intervalo de confianza para la diferencia de proporciones</a></li>
<li class="chapter" data-level="13.5.2" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#intervalos-de-confianza-para-diferencias-de-medias"><i class="fa fa-check"></i><b>13.5.2</b> Intervalos de confianza para diferencias de medias</a></li>
</ul></li>
<li class="chapter" data-level="13.6" data-path="intervalos-de-confianza.html"><a href="intervalos-de-confianza.html#test-11"><i class="fa fa-check"></i><b>13.6</b> Test</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="contrastes-de-hipótesis.html"><a href="contrastes-de-hipótesis.html"><i class="fa fa-check"></i><b>14</b> Contrastes de hipótesis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="contrastes-de-hipótesis.html"><a href="contrastes-de-hipótesis.html#hipótesis-nula-y-alternativa"><i class="fa fa-check"></i><b>14.1</b> Hipótesis nula y alternativa</a></li>
<li class="chapter" data-level="14.2" data-path="contrastes-de-hipótesis.html"><a href="contrastes-de-hipótesis.html#sec:moneda"><i class="fa fa-check"></i><b>14.2</b> Un ejemplo</a></li>
<li class="chapter" data-level="14.3" data-path="contrastes-de-hipótesis.html"><a href="contrastes-de-hipótesis.html#sec:pval"><i class="fa fa-check"></i><b>14.3</b> El p-valor</a></li>
<li class="chapter" data-level="14.4" data-path="contrastes-de-hipótesis.html"><a href="contrastes-de-hipótesis.html#tipo-de-errores"><i class="fa fa-check"></i><b>14.4</b> Tipo de errores</a></li>
<li class="chapter" data-level="14.5" data-path="contrastes-de-hipótesis.html"><a href="contrastes-de-hipótesis.html#sec:exttest"><i class="fa fa-check"></i><b>14.5</b> Ejemplo: El test t</a></li>
<li class="chapter" data-level="14.6" data-path="contrastes-de-hipótesis.html"><a href="contrastes-de-hipótesis.html#la-potencia-de-un-contraste"><i class="fa fa-check"></i><b>14.6</b> La potencia de un contraste</a></li>
<li class="chapter" data-level="14.7" data-path="contrastes-de-hipótesis.html"><a href="contrastes-de-hipótesis.html#intervalo-de-confianza-de-un-contraste"><i class="fa fa-check"></i><b>14.7</b> Intervalo de confianza de un contraste</a></li>
<li class="chapter" data-level="14.8" data-path="contrastes-de-hipótesis.html"><a href="contrastes-de-hipótesis.html#ajuste-de-p-valores"><i class="fa fa-check"></i><b>14.8</b> Ajuste de p-valores</a></li>
<li class="chapter" data-level="14.9" data-path="contrastes-de-hipótesis.html"><a href="contrastes-de-hipótesis.html#resultados-estadísticamente-significativos-versus-resultados-clínicamente-significativos"><i class="fa fa-check"></i><b>14.9</b> Resultados estadísticamente significativos <em>versus</em> resultados clínicamente significativos</a></li>
<li class="chapter" data-level="14.10" data-path="contrastes-de-hipótesis.html"><a href="contrastes-de-hipótesis.html#test-12"><i class="fa fa-check"></i><b>14.10</b> Test</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="qué-test-usar.html"><a href="qué-test-usar.html"><i class="fa fa-check"></i><b>15</b> ¿Qué test usar?</a>
<ul>
<li class="chapter" data-level="15.1" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-para-medias"><i class="fa fa-check"></i><b>15.1</b> Contrastes para medias</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-para-una-media"><i class="fa fa-check"></i><b>15.1.1</b> Contrastes para una media</a></li>
<li class="chapter" data-level="15.1.2" data-path="qué-test-usar.html"><a href="qué-test-usar.html#inciso-tests-de-normalidad"><i class="fa fa-check"></i><b>15.1.2</b> Inciso: tests de normalidad</a></li>
<li class="chapter" data-level="15.1.3" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-para-dos-medias"><i class="fa fa-check"></i><b>15.1.3</b> Contrastes para dos medias</a></li>
<li class="chapter" data-level="15.1.4" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-para-más-de-dos-medias"><i class="fa fa-check"></i><b>15.1.4</b> Contrastes para más de dos medias</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-para-varianzas"><i class="fa fa-check"></i><b>15.2</b> Contrastes para varianzas</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-bilaterales-para-dos-varianzas"><i class="fa fa-check"></i><b>15.2.1</b> Contrastes bilaterales para dos varianzas</a></li>
<li class="chapter" data-level="15.2.2" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-de-homogeneidad-para-más-de-dos-varianzas"><i class="fa fa-check"></i><b>15.2.2</b> Contrastes de homogeneidad para más de dos varianzas</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-para-proporciones"><i class="fa fa-check"></i><b>15.3</b> Contrastes para proporciones</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-para-una-proporción"><i class="fa fa-check"></i><b>15.3.1</b> Contrastes para una proporción</a></li>
<li class="chapter" data-level="15.3.2" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-para-dos-proporciones"><i class="fa fa-check"></i><b>15.3.2</b> Contrastes para dos proporciones</a></li>
<li class="chapter" data-level="15.3.3" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-para-más-de-dos-proporciones"><i class="fa fa-check"></i><b>15.3.3</b> Contrastes para más de dos proporciones</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-para-distribuciones"><i class="fa fa-check"></i><b>15.4</b> Contrastes para distribuciones</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-de-bondad-de-ajuste-de-una-muestra-a-una-distribución"><i class="fa fa-check"></i><b>15.4.1</b> Contrastes de bondad de ajuste de una muestra a una distribución</a></li>
<li class="chapter" data-level="15.4.2" data-path="qué-test-usar.html"><a href="qué-test-usar.html#sec:testindep"><i class="fa fa-check"></i><b>15.4.2</b> Contrastes de igualdad de dos o más distribuciones</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="qué-test-usar.html"><a href="qué-test-usar.html#contrastes-de-correlación"><i class="fa fa-check"></i><b>15.5</b> Contrastes de correlación</a></li>
<li class="chapter" data-level="15.6" data-path="qué-test-usar.html"><a href="qué-test-usar.html#test-13"><i class="fa fa-check"></i><b>15.6</b> Test</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="regresión-lineal.html"><a href="regresión-lineal.html"><i class="fa fa-check"></i><b>16</b> Regresión lineal</a>
<ul>
<li class="chapter" data-level="16.1" data-path="regresión-lineal.html"><a href="regresión-lineal.html#sec:rls"><i class="fa fa-check"></i><b>16.1</b> Regresión lineal simple</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="regresión-lineal.html"><a href="regresión-lineal.html#la-recta-de-regresión-lineal-por-mínimos-cuadrados"><i class="fa fa-check"></i><b>16.1.1</b> La recta de regresión lineal por mínimos cuadrados</a></li>
<li class="chapter" data-level="16.1.2" data-path="regresión-lineal.html"><a href="regresión-lineal.html#el-coeficiente-de-determinación"><i class="fa fa-check"></i><b>16.1.2</b> El coeficiente de determinación</a></li>
<li class="chapter" data-level="16.1.3" data-path="regresión-lineal.html"><a href="regresión-lineal.html#sec:confintrls"><i class="fa fa-check"></i><b>16.1.3</b> Intervalos de confianza</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="regresión-lineal.html"><a href="regresión-lineal.html#regresión-lineal-múltiple"><i class="fa fa-check"></i><b>16.2</b> Regresión lineal múltiple</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="regresión-lineal.html"><a href="regresión-lineal.html#la-función-de-regresión-lineal-múltiple"><i class="fa fa-check"></i><b>16.2.1</b> La función de regresión lineal múltiple</a></li>
<li class="chapter" data-level="16.2.2" data-path="regresión-lineal.html"><a href="regresión-lineal.html#coeficientes-de-determinación"><i class="fa fa-check"></i><b>16.2.2</b> Coeficientes de determinación</a></li>
<li class="chapter" data-level="16.2.3" data-path="regresión-lineal.html"><a href="regresión-lineal.html#intervalos-de-confianza-1"><i class="fa fa-check"></i><b>16.2.3</b> Intervalos de confianza</a></li>
<li class="chapter" data-level="16.2.4" data-path="regresión-lineal.html"><a href="regresión-lineal.html#adecuación-del-modelo"><i class="fa fa-check"></i><b>16.2.4</b> Adecuación del modelo</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="regresión-lineal.html"><a href="regresión-lineal.html#regresión-logística"><i class="fa fa-check"></i><b>16.3</b> Regresión logística</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bioestadística (Medicina UIB)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regresión-lineal" class="section level1 hasAnchor" number="16">
<h1><span class="header-section-number">Lección 16</span> Regresión lineal<a href="regresión-lineal.html#regresión-lineal" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Terminábamos el tema anterior con los contrastes de correlación. Recordad que en un contraste de correlación bilateral buscamos evidencia estadística de que la correlación entre dos variables continuas definidas sobre una misma población es no nula y por lo tanto de que dependen linealmente la una de la otra. En este tema iremos un paso más allá y estimaremos esta dependencia lineal, que representaremos expresando una de las variables, la variable <strong>dependiente</strong>, como una función lineal de la otra, la variable <strong>independiente</strong>.</p>
<p>En estadística descriptiva, la estimación de esta fórmula lineal nos permite añadir al gráfico de dispersión de una muestra de ambas variables “la recta que más se aproxima a los puntos del gráfico”. Ya hablamos de esta recta en la Sección <a href="descripción-de-datos-cuantitativos.html#sec:edbivar">9.11</a>, donde la llamamos <strong>recta de regresión</strong>. Ahora, en estadística inferencial, esta recta de regresión nos permite, por ejemplo, predecir el valor de la variable dependiente sobre un individuo del que sepamos el valor de la variable independiente. Naturalmente, esta predicción conllevará una cierta incertidumbre que dependerá de la “confianza” que queramos tener en el valor predicho.</p>
<p>En los párrafos anteriores hablábamos solo de estudiar la dependencia lineal de una variable continua respecto de otra variable continua. Este es el contexto de la <strong>regresión lineal simple</strong>. Pero, naturalmente, podemos estar interesados en otras situaciones: por ejemplo, puede que nos interese estudiar la dependencia lineal de una variable continua respecto de varias variables continuas, y no solo de una sola, en la <strong>regresión lineal múltiple</strong>, o de una variable aleatoria discreta respecto de una o varias variables continuas o discretas, para lo que usaríamos <strong>regresión lineal generalizada</strong>.</p>
<p>Aunque la regresión lineal simple es un caso particular de la regresión lineal múltiple, empezaremos tratando en detalle la primera ya que es la más sencilla. Por otro lado, de la regresión lineal generalizada solo explicaremos el tipo más útil en medicina: una variable binaria como función lineal de una o varias variables también binarias, los que nos permitirá calcular <strong>odds ratios ajustadas</strong>: la OR de la variable dependiente relativa a cada una de las variables independientes <em>tras descontar el efecto de las otras variables independientes.</em></p>
<div id="sec:rls" class="section level2 hasAnchor" number="16.1">
<h2><span class="header-section-number">16.1</span> Regresión lineal simple<a href="regresión-lineal.html#sec:rls" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Empezamos planteando un ejemplo que nos acompañará a lo largo de toda esta sección:</p>
<div class="example">
<p><span id="exm:VEF" class="example"><strong>Ejemplo 16.1  </strong></span>Con el objetivo de estudiar la relación entre la altura y el VEF1 (el Volumen Espiratorio Forzado en 1 segundo) en los jóvenes, se midieron ambos valores en una muestra de 20 estudiantes varones sanos. Los datos obtenidos (las alturas en cm y el VEF1 en litros) están recogidos en el fichero <a href="https://raw.githubusercontent.com/AprendeR-UIB/INREMDN/master/Dades/VEF.csv">VEF.csv</a>.</p>
</div>
<p>El gráfico de dispersión siguiente muestra los pares altura-VEF1 de los sujetos de esta muestra.</p>
<p><img src="INREMDN_files/figure-html/unnamed-chunk-651-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>En la Sección <a href="descripción-de-datos-cuantitativos.html#sec:edbivar">9.11</a> añadíamos a este gráfico la <em>recta de regresión</em> que “más se aproxima” a los puntos:</p>
<p><img src="INREMDN_files/figure-html/unnamed-chunk-652-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>En ese momento, esta recta nos permitía visualizar mejor la tendencia al crecimiento lineal conjunto de las dos variables en la muestra. Esta tendencia es estadísticamente significativa, como muestra el análisis de estos datos en <strong>Regresión/Matriz de Correlaciones</strong> de JAMOVI:</p>
<p><img src="INREMDN_files/figure-html/jamoviRLS0.png" width="100%" style="display: block; margin: auto;" /></p>
<p>La correlación de Pearson entre las alturas y los VEF1 de la muestra vale 0.581, y en el contraste de hipótesis <span class="math inline">\(\rho_{\text{Altura, VEF1}}=0\)</span> contra <span class="math inline">\(\rho_{\text{Altura, VEF1}}&gt;0\)</span> obtenemos un p-valor de 0.004 y un intervalo de confianza del 95% para <span class="math inline">\(\rho_{\text{Altura, VEF1}}\)</span> entre 0.259 y 1. Marcando todas las casillas de “Gráficas” hemos obtenido el gráfico de dispersión de la muestra con la recta de regresión y además las gráficas de las densidades estimadas de las alturas y los VEF1. La franja gris alrededor de la recta de regresión indica, para cada altura, el intervalo de confianza del 95% para el VEF1 esperado en los jóvenes sanos de esa altura.</p>
<p>Nuestro objetivo en este tema es estimar la dependencia lineal del VEF1 en función de la altura en el total de la población de los varones jóvenes sanos, de cuya existencia hemos obtenido evidencia, y usarla, por ejemplo, para estimar el VEF1 esperado de un joven a partir de su altura. Este tipo de problemas forman el ámbito de la <strong>regresión lineal simple</strong>, donde <em>simple</em> indica que usamos una sola variable independiente (por oposición a la regresión lineal <strong>múltiple</strong>, en la que usamos más de una variable independiente).</p>
<div id="la-recta-de-regresión-lineal-por-mínimos-cuadrados" class="section level3 hasAnchor" number="16.1.1">
<h3><span class="header-section-number">16.1.1</span> La recta de regresión lineal por mínimos cuadrados<a href="regresión-lineal.html#la-recta-de-regresión-lineal-por-mínimos-cuadrados" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>La situación general en una regresión lineal simple es la siguiente. Tenemos dos variables <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span> continuas definidas sobre una población y queremos modelar <span class="math inline">\(Y\)</span> como una función lineal de <span class="math inline">\(X\)</span>. Para ello, medimos estas variables sobre una muestra de <span class="math inline">\(n\)</span> sujetos de la población y obtenemos un conjunto de pares de valores <span class="math inline">\((x_i,y_i)_{i=1,2,\ldots,n}\)</span>.</p>
<p>En este contexto, llamamos a <span class="math inline">\(X\)</span> la variable <strong>independiente</strong> y a <span class="math inline">\(Y\)</span> la variable <strong>dependiente</strong>. La variable independiente no tiene por qué ser aleatoria, en el sentido de que podría ser que nosotros impusiéramos sus valores sobre los sujetos de la muestra. Por ejemplo, <span class="math inline">\(X\)</span> podría ser la dosis de una medicina y que nosotros asignásemos a cada sujeto de la muestra una dosis concreta, no al azar. En cambio, la variable <span class="math inline">\(Y\)</span> sí que tiene que ser aleatoria; si no lo fuera, no tendría sentido usar estadística para estudiarla.</p>
<p>Suponemos que, a nivel poblacional, <em>el valor esperado de <span class="math inline">\(Y\)</span> en un individuo es una función lineal de su valor de <span class="math inline">\(X\)</span></em>.</p>

<div class="rmdromans">
Si supiéramos que <span class="math inline">\(Y\)</span> no depende linealmente de <span class="math inline">\(X\)</span>, ¿para qué íbamos a preocuparnos en modelar <span class="math inline">\(Y\)</span> como una función lineal de <span class="math inline">\(X\)</span>?
</div>
<p>Formalmente, si llamamos</p>
<ul>
<li><p><span class="math inline">\(Y|x\)</span> a la variable aleatoria <span class="math inline">\(Y\)</span> restringida a los individuos en los que <span class="math inline">\(X\)</span> vale <span class="math inline">\(x\)</span></p></li>
<li><p><span class="math inline">\(\mu_{Y|x}\)</span> al valor esperado de <span class="math inline">\(Y|x\)</span>, es decir, al valor medio de la variable <span class="math inline">\(Y\)</span> sobre todos los individuos de la población en los que <span class="math inline">\(X\)</span> vale <span class="math inline">\(x\)</span></p></li>
</ul>
<p>suponemos que existen coeficientes <span class="math inline">\(\beta_0,\beta_1\in \mathbb{R}\)</span> tales que
<span class="math display">\[
\mu_{Y|x}=\beta_0+\beta_1 x.
\]</span></p>
<p>Los coeficientes <span class="math inline">\(\beta_0\)</span> (el <strong>término constante</strong> o <strong>independiente</strong> de la función lineal) y <span class="math inline">\(\beta_1\)</span> (su <strong>pendiente</strong>) son parámetros que queremos estimar. Por la forma de esta función lineal, el significado de estos coeficientes es el siguiente:</p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> es el valor esperado de <span class="math inline">\(Y\)</span> en los individuos en los que <span class="math inline">\(X=0\)</span></p></li>
<li><p><span class="math inline">\(\beta_1\)</span> es el incremento esperado del valor de <span class="math inline">\(Y\)</span> cuando el valor de <span class="math inline">\(X\)</span> aumenta en 1 unidad</p></li>
</ul>
<p>Tomamos una muestra <span class="math inline">\((x_i,y_i)_{i=1,\ldots,n}\)</span> de <span class="math inline">\(n\)</span> valores de <span class="math inline">\((X,Y)\)</span> y con ella obtenemos estimaciones <span class="math inline">\(b_0,b_1\)</span> de <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span>. Estas estimaciones definen la <strong>recta de regresión</strong> de <span class="math inline">\(Y\)</span> en función de <span class="math inline">\(X\)</span>
<span class="math display">\[
y=b_0+b_1 x
\]</span></p>
<p>Esta recta sirve, por ejemplo, para, dado un valor <span class="math inline">\(x_0\)</span> de <span class="math inline">\(X\)</span>, estimar el valor esperado de <span class="math inline">\(Y\)</span> en los individuos en los que <span class="math inline">\(X\)</span> valga <span class="math inline">\(x_0\)</span>. Denotaremos por <span class="math inline">\(\widehat{y}\)</span> el valor <strong>estimado</strong> de <span class="math inline">\(Y\)</span> en un sujeto cuyo valor de <span class="math inline">\(X\)</span> sea <span class="math inline">\(x\)</span> usando la recta de regresión:
<span class="math display">\[
\widehat{y}=b_0+b_1 x
\]</span></p>
<p>Hay varias técnicas para estimar los coeficientes <span class="math inline">\(\beta_0,\beta_1\)</span>. Aquí vamos a explicar la más popular: la <strong>regresión lineal por mínimos cuadrados</strong>. La idea es que tomamos como <span class="math inline">\(y=b_0+b_1 x\)</span> la recta que minimiza su suma de distancias verticales desde los puntos de la muestra.</p>
<p>En concreto, dados <span class="math inline">\(b_0,b_1\)</span>, llamamos el <strong>error</strong> del modelo <span class="math inline">\(\widehat{y}=b_0+b_1 x\)</span> en el punto <span class="math inline">\(i\)</span>-ésimo de la muestra <span class="math inline">\((x_i,y_i)\)</span> a la diferencia <span class="math inline">\(e_i\)</span> entre el valor <span class="math inline">\(y_i\)</span> de <span class="math inline">\(Y\)</span> en este punto y su valor estimado <span class="math inline">\(\widehat{y}_i\)</span> de <span class="math inline">\(Y\)</span>:
<span class="math display">\[
e_i=y_i-\widehat{y}_i=y_i-b_0-b_1 x_i
\]</span>
El valor absoluto de <span class="math inline">\(e_i\)</span> es la <strong>distancia vertical</strong> del punto <span class="math inline">\((x_i,y_i)\)</span> a la recta <span class="math inline">\(y=b_0+b_1 x\)</span>: la longitud del segmento vertical que une el punto con la recta. El gráfico siguiente muestra estos errores para nuestra muestra de alturas y VEF1 y la recta de regresión que hemos dibujado.</p>
<p><img src="INREMDN_files/figure-html/unnamed-chunk-654-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>Los <strong>estimadores por mínimos cuadrados</strong> de <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> son entonces los valores <span class="math inline">\(b_0,b_1\)</span> que minimizan la suma de los cuadrados de estos errores: es decir, los valores <span class="math inline">\(b_0,b_1\)</span> tales que el valor de la suma
<span class="math display">\[
\sum_{i=1}^n (y_i-b_0-b_1 x_i)^2
\]</span>
es mínimo.</p>
<p>Derivando, igualando a 0, operando etc. obtenemos el resultado siguiente, que ya anunciamos en la Sección <a href="descripción-de-datos-cuantitativos.html#sec:edbivar">9.11</a>:</p>
<div class="theorem">
<p><span id="thm:unnamed-chunk-655" class="theorem"><strong>Teorema 16.1  </strong></span>Los estimadores por mínimos cuadrados <span class="math inline">\(b_0\)</span> y <span class="math inline">\(b_1\)</span> de <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> a partir de la muestra <span class="math inline">\((x_i,y_i)_{i=1,\ldots,n}\)</span> son
<span class="math display">\[
b_1 =\frac{s_{x,y}}{s_x^2},\quad b_0 = \overline{y}-b_1 \overline{x}
\]</span>
donde <span class="math inline">\(s_{x,y}\)</span> es la covarianza de los vectores <span class="math inline">\(x=(x_1,\ldots,x_n)\)</span> e <span class="math inline">\(y=(y_1,\ldots,y_n)\)</span>, <span class="math inline">\(\overline{x}\)</span> e <span class="math inline">\(\overline{y}\)</span> son sus respectivas medias muestrales y <span class="math inline">\(s_x^2\)</span> es la varianza de <span class="math inline">\(x\)</span>.</p>
</div>
<p>En JAMOVI, la recta de regresión por mínimos cuadrados de <span class="math inline">\(Y\)</span> en función de <span class="math inline">\(X\)</span> se calcula en <strong>Regresión/Regresión lineal</strong>. En nuestro ejemplo, para calcular la recta de regresión por mínimos cuadrados de <code>VEF1</code> en función de <code>Altura</code>, seleccionaríamos <code>Altura</code> como “Covariable” (otra manera de llamar a las variables independientes) y <code>VEF1</code> como “Variable dependiente” y obtendríamos la ventana siguiente:</p>
<p><img src="INREMDN_files/figure-html/jamoviRLS1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>La columna “Estimador” de la tabla “Coeficientes del Modelo - VEF1” nos da los valores de <span class="math inline">\(b_0\)</span> (fila “Constante”) y <span class="math inline">\(b_1\)</span> (fila “Altura”). Por lo tanto, hemos obtenido la recta de regresión
<span class="math display">\[
y=-9.1904+0.0744x
\]</span>
Es decir, estimamos que en la población de los jóvenes varones sanos se cumple la relación
<span class="math display">\[
\mbox{VEF1}=-9.1904+  0.0744\cdot \mbox{Altura}
\]</span></p>
<p>De este modelo deducimos que si un joven sano mide 1 cm más que otro, esperamos que su VEF1 sea 7.44 centilitros mayor.</p>

<div class="rmdromans">
<p>También deducimos que el VEF1 esperado de un joven de 0 cm es de -9.1904 litros, pero esto, naturalmente, no tiene ningún sentido.</p>
Para evitar hablar de VEF1 negativos en jóvenes que no pueden existir, una posible estrategia es, en vez de tomar como variable independiente la altura, tomar la diferencia entre la altura y un cierto valor base razonable, de manera que el 0 corresponda a ese valor base. Por ejemplo, tomar como variable independiente la diferencia entre la altura y 140 cm.
</div>
<div class="example">
<p><span id="exm:VEF1-165" class="example"><strong>Ejemplo 16.2  </strong></span>¿Qué VEF1 esperamos en un estudiante varón sano de 165 cm?</p>
</div>
<p>Según el modelo lineal obtenido, el valor esperado de VEF1 cuando <span class="math inline">\(\mbox{Altura}=175\)</span> es <span class="math inline">\(-9.1904+0.0744\cdot 165=3.086\)</span>. Aunque naturalmente, a estas altura hemos de tener claro que hemos de acompañar esta estimación puntual con un intervalo de confianza. Los estudiaremos en la Sección <a href="regresión-lineal.html#sec:confintrls">16.1.3</a>.</p>
<p>La recta de regresión por mínimos cuadrados tiene las dos propiedades siguientes:</p>
<ul>
<li><p>Por la fórmula que calcula <span class="math inline">\(b_0\)</span>, la recta pasa por el punto medio <span class="math inline">\((\overline{x},\overline{y})\)</span> de la muestra:
<span class="math display">\[
b_0+b_1 \overline{x}=\overline{y}
\]</span></p></li>
<li><p>La media <span class="math inline">\(\overline{\,\widehat{y}\,}\)</span> de los valores estimados de <span class="math inline">\(Y\)</span> en los puntos de la muestra es igual a la media de los valores de <span class="math inline">\(Y\)</span> en la muestra, porque
<span class="math display">\[
\overline{\,\widehat{y}\,}=\frac{1}{n}\sum_{i=1}^n \widehat{y}_i=
\frac{1}{n}\sum_{i=1}^n (b_0+b_1x_i)=b_0+b_1\cdot \frac{\sum_{i=1}^n x_i}{n}=b_0+b_1 \overline{x}= \overline{y}
\]</span></p></li>
</ul>
</div>
<div id="el-coeficiente-de-determinación" class="section level3 hasAnchor" number="16.1.2">
<h3><span class="header-section-number">16.1.2</span> El coeficiente de determinación<a href="regresión-lineal.html#el-coeficiente-de-determinación" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En principio, la adecuación de la recta de regresión lineal obtenida para modelar <span class="math inline">\(Y\)</span> como función lineal de <span class="math inline">\(X\)</span> se mide por medio del valor absoluto <span class="math inline">\(|r_{x,y}|\)</span> de la correlación de Pearson de <span class="math inline">\(x=(x_1,\ldots,x_n)\)</span> e <span class="math inline">\(y=(y_1,\ldots,y_n)\)</span>. Recordemos que <span class="math inline">\(r_{x,y}\)</span> estima la correlación de Pearson <span class="math inline">\(\rho_{X,Y}\)</span> de las variables <span class="math inline">\(X,Y\)</span>, y que cuanto mayor es el valor absoluto de <span class="math inline">\(\rho_{X,Y}\)</span>, más se aproxima <span class="math inline">\(Y\)</span> a ser una función lineal de <span class="math inline">\(X\)</span>.</p>
<p>Ahora bien, por motivos que explicamos un poco más abajo, en la práctica en vez de usar este valor absoluto <span class="math inline">\(|r_{x,y}|\)</span> se usa el cuadrado de la regresión, <span class="math inline">\(r_{x,y}^2\)</span>: cuánto mayor sea este cuadrado, mayor será <span class="math inline">\(|r_{x,y}|\)</span> y por lo tanto más se aproxima <span class="math inline">\(Y\)</span> a ser una función lineal de <span class="math inline">\(X\)</span>. En el contexto de la regresión lineal por mínimos cuadrado, a <span class="math inline">\(r_{x,y}^2\)</span> se le llama el <strong>coeficiente de determinación</strong> y se lo denota por <span class="math inline">\(R^2\)</span>. Como <span class="math inline">\(r_{x,y}\)</span> toma valores entre -1 y 1, <span class="math inline">\(R^2\)</span> toma valores entre 0 y 1.</p>
<p>JAMOVI da el <span class="math inline">\(R^2\)</span> en la tabla “Medidas de ajuste del modelo” al calcular la recta de regresión: <span class="math inline">\(R\)</span> es la correlación de Pearson y <span class="math inline">\(R^2\)</span> su cuadrado, el coeficiente de determinación. El de nuestro ejemplo vale 0.338.</p>

<div class="rmdcorbes">
<p>El motivo por el que se usa <span class="math inline">\(R^2\)</span> y no <span class="math inline">\(|r_{x,y}|\)</span> es que, calculando un poco, se obtiene que el coeficiente de determinación es igual a <em>la varianza de los valores estimados</em> de <span class="math inline">\(Y\)</span> sobre la muestra usada dividida por <em>la varianza de los valores observados</em> de <span class="math inline">\(Y\)</span> en la muestra:
<span class="math display">\[
r_{x,y}^2=\frac{s_{\widehat{y}}^2}{s_y^2}.
\]</span>
Es decir, <span class="math inline">\(R^2\)</span> mide la fracción de la varianza de <span class="math inline">\(y\)</span> que “explica” la varianza de los valores estimados <span class="math inline">\(\widehat{y}\)</span>.</p>
<p>Esta medida también tendrá sentido en la regresión lineal múltiple, y además entronca con la filosofía del ANOVA, en el que se toman como estadísticos “cocientes de variabilidades”, por lo que se prefiere este cociente a <span class="math inline">\(|r_{x,y}|\)</span>.</p>
</div>

<div class="rmdcaution">
Como ya os comentamos en la Sección <a href="descripción-de-datos-cuantitativos.html#sec:edbivar">9.11</a>,
no es conveniente valorar la bondad del modelo solo con el valor de <span class="math inline">\(r_{x,y}\)</span> o, equivalentemente, de <span class="math inline">\(R^2\)</span>: conviene <strong>siempre</strong> dibujar el gráfico de dispersión y la recta de regresión. Recordad los conjuntos de datos de Anscombe que mostrábamos en el Ejemplo <a href="descripción-de-datos-cuantitativos.html#exm:Anscombe">9.22</a> y que volvemos a dibujar en el gráfico que sigue: los cuatro conjuntos de puntos tienen la misma recta de regresión y el mismo <span class="math inline">\(R^2\)</span>, 0.666, pero se ajustan de maneras muy diferentes a la recta de regresión.
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:anscombe2"></span>
<img src="INREMDN_files/figure-html/anscombe2-1.png" alt="El cuarteto de Anscombe" width="90%" />
<p class="caption">
Figura 16.1: El cuarteto de Anscombe
</p>
</div>
</div>
<div id="sec:confintrls" class="section level3 hasAnchor" number="16.1.3">
<h3><span class="header-section-number">16.1.3</span> Intervalos de confianza<a href="regresión-lineal.html#sec:confintrls" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Bien, ya sabemos calcular la recta de regresión por mínimos cuadrados a partir de una muestra. Pero hay que recordar que sus coeficientes <span class="math inline">\(b_0,b_1\)</span> son <em>estimaciones</em> de los coeficientes “verdaderos” de la relación <span class="math inline">\(\mu_{Y|x}=\beta_0+\beta_1 x\)</span>. Cuando estimamos algo a partir de una muestra, es conveniente controlar el error de la estimación mediante intervalos de confianza, que en este caso nos dirán, para un nivel de confianza dado, entre qué valores creemos que se mueven los valores reales de <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span>. Y claro, la incertidumbre en la estimación de <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> forzosamente se traducirá en una incertidumbre en las predicciones realizadas usando la recta de regresión, que también describiremos mediante intervalos de confianza.</p>
<p>Como siempre, para poder usar fórmulas paramétricas para calcular intervalos de confianza necesitamos que se verifiquen algunas condiciones sobre las variables involucradas. En este caso, las condiciones que vamos a suponer que se cumplen son:</p>
<blockquote>
<p>Las variables aleatorias error <span class="math inline">\(E_i=Y|x_i-\beta_0-\beta_1 x_i\)</span> tienen todas la misma distribución normal de media 0, y son incorreladas dos a dos (<span class="math inline">\(\sigma_{E_i,E_j}=0\)</span> si <span class="math inline">\(i\neq j\)</span>).</p>
</blockquote>
<p>Si estas condiciones se satisfacen, entonces:</p>
<ul>
<li><p>El valor esperado de <span class="math inline">\(b_0\)</span> es <span class="math inline">\(\beta_0\)</span> y el valor esperado de <span class="math inline">\(b_1\)</span> es <span class="math inline">\(\beta_1\)</span>: <span class="math inline">\(b_0\)</span> y <span class="math inline">\(b_1\)</span> son estimadores <strong>insesgados</strong> de <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span>.</p></li>
<li><p>Entre todos los estimadores insesgados de <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(b_0\)</span> y <span class="math inline">\(b_1\)</span> son los que tienen menor error típico (son los más <strong>precisos</strong>)</p></li>
<li><p>Unos estadísticos relacionados con <span class="math inline">\(b_0\)</span> y <span class="math inline">\(b_1\)</span> (y que no vamos a dar, tranquilos) tienen distribuciones t de Student conocidas, lo que permite calcular intervalos de confianza para <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span> y <span class="math inline">\(\mu_{Y|x_0}\)</span> centrados en las estimaciones.</p></li>
</ul>
<p>Con JAMOVI podéis comprobar si se puede aceptar si las variables error <span class="math inline">\(E_i\)</span> cumplen las suposiciones que hemos hecho para que el cálculo de intervalos de confianza tenga sentido en <strong>Regresión/Regresión lineal/Comprobaciones de supuestos</strong>. En la regresión lineal simple nos interesan la “Prueba de normalidad” y la “Prueba de autocorrelación”:</p>
<p><img src="INREMDN_files/figure-html/jamoviRLS2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Los p-valores del test de normalidad y del test de autocorrelación son grandes, por lo que podemos aceptar que todas la variables <span class="math inline">\(E_i\)</span> tienen la misma distribución normal de media 0 y que están incorreladas. La conclusión sobre la normalidad de los residuos la hemos ilustrado con su q-q-plot.</p>
<p>Para calcular con JAMOVI los intervalos de confianza para <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> tenéis que ir a <strong>Regresión/Regresión lineal/Coeficientes del modelo</strong> y marcar “Intervalo de confianza” y especificar el nivel de confianza:</p>
<p><img src="INREMDN_files/figure-html/jamoviRLS3.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Concluimos con un 95% de confianza que <span class="math inline">\(\beta_0\)</span> está entre -18.238 y -0.143 y que <span class="math inline">\(\beta_1\)</span> está entre 0.023 y 0.126. En la última columna, “p”, de la tabla “Coeficientes del modelo” se da el p-valor de los contrastes bilaterales <span class="math inline">\(\beta_i=0\)</span> contra <span class="math inline">\(\beta_i\neq 0\)</span>.</p>
<p>Aquí es el momento de preguntarnos, más allá del contraste de correlación, si realmente el modelo lineal era adecuado o no. Si no podemos rechazar que <span class="math inline">\(\beta_1=0\)</span>, no podemos concluir que el modelo de regresión lineal tenga sentido: <span class="math inline">\(\beta_1=0\)</span> significaría que <span class="math inline">\(\mu_{Y|x}=\beta_0\)</span> para todo <span class="math inline">\(x\)</span>, es decir, que el valor esperado de <span class="math inline">\(Y\)</span> en un individuo no depende del valor de <span class="math inline">\(X\)</span>. En nuestro ejemplo, el p-valor del contraste <span class="math inline">\(\beta_1=0\)</span> contra <span class="math inline">\(\beta_1\neq 0\)</span> es 0.007, por lo que tenemos evidencia estadísticamente significativa de que <span class="math inline">\(\beta_1\neq 0\)</span> y por lo tanto de que el valor de VEF1 de una persona depende linealmente de su altura.</p>
<p>Pasemos a los intervalos de confianza para la predicción del valor de <span class="math inline">\(Y\)</span> dado un valor concreto <span class="math inline">\(x_0\)</span> de <span class="math inline">\(X\)</span>. Aquí podemos distinguir dos preguntas:</p>
<ul>
<li><p>¿Cuál es el valor <strong>esperado</strong> de <span class="math inline">\(Y\)</span> en un sujeto en el que <span class="math inline">\(X\)</span> valga <span class="math inline">\(x_0\)</span>? Es decir, ¿qué vale el valor medio de <span class="math inline">\(Y\)</span> en los sujetos en los que <span class="math inline">\(X\)</span> vale <span class="math inline">\(x_0\)</span>?</p>
<p>Por ejemplo, ¿cuál es el VEF1 medio de los jóvenes varones sanos que miden 165 cm?</p></li>
<li><p>Dado un sujeto concreto cuya <span class="math inline">\(X\)</span> vale <span class="math inline">\(x_0\)</span>, ¿qué vale su <span class="math inline">\(Y\)</span>?</p>
<p>Por ejemplo, si Pep es un joven sano que mide 1.65 ¿que vale su VEF1?</p></li>
</ul>
<p>Las estimaciones puntuales que responden a ambas preguntas valen lo mismo: <span class="math inline">\(\widehat{y}=b_0+b_1x\)</span>. Pero si lo pensamos un poco nos daremos cuenta de que, para un mismo nivel de confianza, el intervalo de confianza del valor esperado de <span class="math inline">\(Y\)</span> será más estrecho que el intervalo de confianza del valor de <span class="math inline">\(Y\)</span> en un sujeto: hay más incertidumbre en la estimación de <span class="math inline">\(Y\)</span> en <em>un sujeto concreto</em> con <span class="math inline">\(X=x_0\)</span> que en la estimación del valor medio de <span class="math inline">\(Y\)</span> en <em>todos los sujetos</em> con <span class="math inline">\(X=x_0\)</span>.</p>
<p>A día de hoy, JAMOVI responde parcialmente a la primera pregunta, para un nivel de confianza dado. Si en <strong>Regresión/Regresión lineal/Medias Marginales Estimadas</strong> arrastramos la variable Altura a la columna “Medias marginales” y marcamos las casillas “Intervalo de confianza” (por ejemplo, del 95%), “Gráfica de medias marginales” y “Tabla de medias marginales”, obtenemos el resultado siguiente:</p>
<p><img src="INREMDN_files/figure-html/jamoviRLS4.png" width="100%" style="display: block; margin: auto;" /></p>
<p>En el gráfico, la región gris marca para cada altura el intervalo de confianza del 95% del VEF1 esperado en las personas de esa altura. Observad cómo este intervalo de confianza se ensancha a medida que la altura se aleja de la media de la muestra. Por otro lado, en la tabla se obtienen los intervalos de confianza del VEF1 esperado para las personas cuya altura es, respectivamente, la media de las alturas de la muestra menos su desviación típica, la altura media y la media de las alturas de la muestra más su desviación típica.</p>
<p>Si queremos calculr el IC-95% para el VEF1 medio de las personas de otra altura concreta, hay que usar las funciones adecuadas de R en la ventana <strong>R/Rj</strong>. A modo de ejemplo, supongamos que queremos calcular el IC-95% para el VEF1 esperado de una persona que mida 165 cm. Los pasos a seguir son los siguientes.</p>
<ul>
<li><p>Extraer vectores con las variables independiente y dependiente de la muestra (y recordad que JAMOVI llama <code>data</code> al resultado de importar una tabla de datos, independientemente del nombre original del fichero). Los llamaremos <code>X</code> e <code>Y</code>.</p>
<p>En nuestro caso, haríamos</p></li>
</ul>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="regresión-lineal.html#cb85-1" tabindex="-1"></a>X<span class="ot">=</span>data<span class="sc">$</span>Altura</span>
<span id="cb85-2"><a href="regresión-lineal.html#cb85-2" tabindex="-1"></a>Y<span class="ot">=</span>data<span class="sc">$</span>VEF1</span></code></pre></div>
<ul>
<li><p>Definir una tabla de datos con el valor de la variable independiente <code>X</code> para el que queramos calcular el intervalo de confianza del valor esperado de la variable dependiente. La llamaremos <code>X.nuevas</code>.</p>
<p>En nuestro caso, entraríamos</p></li>
</ul>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="regresión-lineal.html#cb86-1" tabindex="-1"></a>X.nuevas<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">X=</span><span class="dv">165</span>)</span></code></pre></div>
<ul>
<li>Ejecutar la instrucción</li>
</ul>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="regresión-lineal.html#cb87-1" tabindex="-1"></a><span class="fu">predict</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>X), X.nuevas, <span class="at">interval=</span><span class="st">&quot;confidence&quot;</span>)</span></code></pre></div>
<p>donde <code>X</code> e <code>Y</code> son los vectores con las variables independiente y dependiente de la muestra que hemos definido al principio y <code>X.nuevas</code> es la tabla de datos con los “nuevos” valores de la variable independiente. Si el nivel de confianza deseado es otro que 0.95, se tiene que especificar igualándolo al parámetro <code>level</code>.</p>
<p>Todo entero en JAMOVI:</p>
<p><img src="INREMDN_files/figure-html/jamoviRLS5.png" width="100%" style="display: block; margin: auto;" /></p>
<p>En este resultado, <code>fit</code> es el VEF1 medio estimado cuando Altura=165 (no coincide con nuestra predicción en el Ejemplo <a href="regresión-lineal.html#exm:VEF1-165">16.2</a> porque nosotros hemos tomado los coeficientes redondeados a 4 cifras decimales), y <code>lwr</code> y <code>upr</code> son los extremos inferior y superior para el intervalo de confianza del 95% para el VEF1 medio de las personas de 165 cm. Asi pues, estimamos con un 95% de confianza que el VEF1 medio de los jóvenes sanos de 1.65 m está entre 2.48 y 3.69 litros.</p>
<p>Para estimar el VEF1 de un joven concretp a partir de su altura, el proceso es el mismo, pero en la función <code>predict</code> hay que usar <code>interval="prediction"</code> en vez de <code>interval="confidence"</code>:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="regresión-lineal.html#cb88-1" tabindex="-1"></a><span class="fu">predict</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>X), X.nuevas, <span class="at">interval=</span><span class="st">&quot;prediction&quot;</span>)</span></code></pre></div>
<p><img src="INREMDN_files/figure-html/jamoviRLS6.png" width="100%" style="display: block; margin: auto;" /></p>
<p>En resumen, si Pep fuera un joven sano de 1.65 m:</p>
<ul>
<li><p>Estimaría con un 95% de confianza que su VEF1 está entre 1.71 y 4.46 litros.</p></li>
<li><p>Estimaría con un 95% de confianza que el VEF1 medio de los jóvenes sanos de su altura está entre 2.48 y 3.69 litros.</p></li>
</ul>
<p>Como veis, la predicción del VEF1 de Pep es mucho más incierta que la de su VEF1 “esperado”: es más difícil acertar el VEF1 de una persona que el valor medio del VEF1 de un grupo de personas.</p>
</div>
</div>
<div id="regresión-lineal-múltiple" class="section level2 hasAnchor" number="16.2">
<h2><span class="header-section-number">16.2</span> Regresión lineal múltiple<a href="regresión-lineal.html#regresión-lineal-múltiple" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En el modelo de regresión lineal simple modelábamos una variable dependiente <span class="math inline">\(Y\)</span> en función de una única variable independiente <span class="math inline">\(X\)</span>. Pero normalmente habrá más de una variables que influyan, o que al menos puedan influir, en el comportamiento de <span class="math inline">\(Y\)</span>.
La regresión lineal múltiple trata el problema de estudiar la expresión de una variable dependiente como función lineal de varias variables independientes. El planteamiento es exactamente el mismo que en el caso simple, solo que con más variables independientes.</p>
<div id="la-función-de-regresión-lineal-múltiple" class="section level3 hasAnchor" number="16.2.1">
<h3><span class="header-section-number">16.2.1</span> La función de regresión lineal múltiple<a href="regresión-lineal.html#la-función-de-regresión-lineal-múltiple" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Supongamos que tenemos <span class="math inline">\(k\)</span> variables independientes <span class="math inline">\(X_1,\ldots, X_k\)</span> y una variable aleatoria dependiente <span class="math inline">\(Y\)</span> definidas sobre una población y que <em>el valor esperado de <span class="math inline">\(Y\)</span> en un individuo es una función lineal de sus valores de <span class="math inline">\(X_1,\ldots, X_k\)</span>.</em> Es decir, que si llamamos</p>
<ul>
<li><p><span class="math inline">\(Y|x_1,\ldots,x_k\)</span> a la variable aleatoria <span class="math inline">\(Y\)</span> restringida a los individuos en los que <span class="math inline">\(X_1\)</span> vale <span class="math inline">\(x_1\)</span>, <span class="math inline">\(X_2\)</span> vale <span class="math inline">\(x_2\)</span>, … y <span class="math inline">\(X_k\)</span> vale <span class="math inline">\(x_k\)</span></p></li>
<li><p><span class="math inline">\(\mu_{Y|x_1,\ldots,x_k}\)</span> al valor esperado de <span class="math inline">\(Y|x_1,\ldots,x_k\)</span>; es decir, al valor medio de <span class="math inline">\(Y\)</span> sobre todos los individuos de la población en los que <span class="math inline">\(X_1\)</span> vale <span class="math inline">\(x_1\)</span>, <span class="math inline">\(X_2\)</span> vale <span class="math inline">\(x_2\)</span>,… y <span class="math inline">\(X_k\)</span> vale <span class="math inline">\(x_k\)</span></p></li>
</ul>
<p>suponemos que existen coeficientes <span class="math inline">\(\beta_0,\beta_1,\ldots,\beta_k\in \mathbb{R}\)</span> tales que</p>
<p><span class="math display">\[
  \mu_{Y|x_1,\ldots,x_k}= \beta_0+\beta_1 x_1+\cdots+\beta_k x_k
\]</span></p>
<p>Como en el caso simple:</p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> es el valor esperado de <span class="math inline">\(Y\)</span> en los individuos en los que <span class="math inline">\(X_1=\cdots=X_k=0\)</span></p></li>
<li><p>Cada <span class="math inline">\(\beta_i\)</span>, <span class="math inline">\(i=1,\ldots,k\)</span>, es el incremento esperado del valor de <span class="math inline">\(Y\)</span> cuando el valor de <span class="math inline">\(X_i\)</span> aumenta en 1 unidad y el resto de las variables independientes permanecen constantes.</p></li>
</ul>
<p>Queremos estimar estos coeficientes <span class="math inline">\(\beta_0,\beta_1,\ldots,\beta_k\)</span> a partir de los valores
<span class="math display">\[
  (x_{i,1},x_{i,2},\ldots,x_{i,k},y_i)_{i=1,\ldots,n}
\]</span>
de <span class="math inline">\((X_1,\ldots,X_k,Y)\)</span> sobre una muestra de la población. Usaremos la notación <span class="math inline">\(\underline{x}_i=: (x_{i,1},x_{i,2},\ldots,x_{i,k})\)</span>, para cada <span class="math inline">\(i=1,\ldots,n\)</span>.</p>
<p>Sean <span class="math inline">\(b_0,b_1,\ldots,b_k\)</span> las estimaciones obtenidas de <span class="math inline">\(\beta_0,\beta_1,\ldots,\beta_k\)</span>. Estas estimaciones definen la <strong>función lineal de regresión</strong>
<span class="math display">\[
y=b_0+b_1 x_1+\cdots+b_kx_k
\]</span></p>
<p>Como en el caso simple, dado un sujeto de la población con <span class="math inline">\(X_i=x_i\)</span> para cada <span class="math inline">\(i=1,\ldots,k\)</span>, denotaremos por <span class="math inline">\(\widehat{y}\)</span> su valor de <span class="math inline">\(Y\)</span> predicho por esta función, es decir,
<span class="math display">\[
\widehat{y}=b_0+b_1 x_1+\cdots+b_kx_k
\]</span></p>
<p>De nuevo vamos a usar la técnica de <strong>regresión lineal por mínimos cuadrados</strong> para estimar estos coeficientes. Dados <span class="math inline">\(b_0,b_1,\ldots,b_k\)</span>, llamamos el <strong>error</strong> <span class="math inline">\(e_i\)</span> del modelo <span class="math inline">\(y=b_0+b_1 x_1+\cdots+b_kx_k\)</span> en el punto <span class="math inline">\(i\)</span>-ésimo de la muestra <span class="math inline">\((x_{i,1},x_{i,2},\ldots,x_{i,k},y_i)\)</span> a la diferencia entre el valor <span class="math inline">\(y_i\)</span> de <span class="math inline">\(Y\)</span> en este punto y su valor estimado <span class="math inline">\(\widehat{y}_i=b_0+b_1 x_{i,1}+\cdots+b_kx_{i,k}\)</span>:
<span class="math display">\[
e_i=y_i-\widehat{y}_i=y_i-(b_0+b_1 x_{i,1}+\cdots+b_kx_{i,k})
\]</span>
Los <strong>estimadores por mínimos cuadrados</strong> <span class="math inline">\(b_0,b_1,\ldots,b_k\)</span> de <span class="math inline">\(\beta_0,\beta_1,\ldots,\beta_k\)</span> son los que minimizan la suma de los cuadrados de estos errores. Las fórmulas de estos estimadores son más complicadas que en el caso simple, así que no las daremos. Con JAMOVI, se calculan en <strong>Regresión/Regresión lineal</strong>.</p>
<p>Veamos un ejemplo.</p>
<div class="example">
<p><span id="exm:pesoneonato1" class="example"><strong>Ejemplo 16.3  </strong></span>Se postula que el peso de un neonato (<span class="math inline">\(Y\)</span>) es una función lineal de la edad y el peso de la madre al inicio del embarazo (<span class="math inline">\(X_1,X_2\)</span>), la tensión sistólica media de la madre durante el embarazo (<span class="math inline">\(X_3\)</span>), el nivel de colesterol materno a principios del embarazo (<span class="math inline">\(X_4\)</span>) y la edad gestacional en el momento del parto (<span class="math inline">\(X_5\)</span>).</p>
</div>
<p>Hemos recogido estos datos para una muestra de 195 partos simples en el fichero <a href="https://raw.githubusercontent.com/AprendeR-UIB/INREMDN/master/Dades/Datos.neonatos.csv">Datos.neonatos.csv</a>. En esta tabla, la edad de la madre está en años y su peso en kg, la edad gestacional en semanas, la tensión en mm Hg, el nivel de colesterol en mg/dl y el peso del neonato en gramos.</p>
<p>El modelo que suponemos es
<span class="math display">\[
\mu_{Y|x_1,x_2,x_3,x_4,x_5}=\beta_0+\beta_1x_1+\beta_2x_2+\beta_3x_3+\beta_4x_4+\beta_5x_5
\]</span>
y a partir de nuestra muestra queremos estimar los coeficientes <span class="math inline">\(\beta_0,\ldots,\beta_5\)</span> de este modelo para luego poder predecir el peso neonatal en función de las características maternas.</p>
<p>Para ello, tras importar la tabla de datos en JAMOVI, en <strong>Regresión/Regresión lineal</strong> seleccionamos <code>Peso.neonato</code> como “Variable dependiente” y el resto de variables como “Covariables”:</p>
<p><img src="INREMDN_files/figure-html/jamoviRLM1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>La columna “Estimador” de la tabla que resulta contiene los coeficientes estimados de la función de regresión lineal:
<span class="math display">\[
y=-5417.14+11.18x_1+5.37x_2-1.68x_3+8.69x_4+166.07x_5
\]</span>
es decir,
<span class="math display">\[
\begin{array}{rl}
\text{Peso.neonato}\ =\!\!\!\!\! &amp; -5417.14+11.18\cdot \text{Edad.madre}+5.37\cdot \text{Peso.madre}\\
&amp;\quad -1.68\cdot\text{Tensión.sistólica}+8.69\cdot\text{Nivel.colesterol}\\
&amp;\quad +166.07\cdot\text{Edad.gestacional}
\end{array}
\]</span></p>
<p>A partir de este modelo podemos predecir el aumento esperado del peso del neonato asociado al aumento en una unidad de cada variable independiente si las otras variables permanecen constantes. Por ejemplo, a igualdad de los valores del resto de variables independientes, el aumento de 1 mg/dl en el nivel de colesterol basal está asociado a un aumento esperado de 8.7 gramos del neonato.</p>
<p>La función de regresión lineal por mínimos cuadrados tiene las dos propiedades siguientes, que extienden a más de una variable independiente las propiedades de la recta de regresión por mínimos cuadrados:</p>
<ul>
<li><p>El hiperplano de regresión pasa por el vector de medias muestrales <span class="math inline">\((\overline{x}_1,\overline{x}_2,\ldots,\overline{x}_k,\overline{y})\)</span>:
<span class="math display">\[
\overline{y}=b_0+b_1 \overline{x}_1+\cdots+b_1 \overline{x}_k
\]</span></p></li>
<li><p>La media de los valores estimados de la variable dependiente en la muestra es igual a la media de sus valores observados:
<span class="math display">\[
\overline{\,\widehat{y}\,}=\overline{y}
\]</span></p></li>
</ul>
</div>
<div id="coeficientes-de-determinación" class="section level3 hasAnchor" number="16.2.2">
<h3><span class="header-section-number">16.2.2</span> Coeficientes de determinación<a href="regresión-lineal.html#coeficientes-de-determinación" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El <strong>coeficiente de determinación</strong> de una regresión lineal múltiple es
<span class="math display">\[
    R^2=\frac{s^2_{\widehat{y}}}{s^2_y}
\]</span>
Su valor está entre 0 y 1 y cuanto más se acerque a 1, mejor consideramos el modelo lineal obtenido. JAMOVI lo da en la tabla “Medidas de Ajuste del Modelo”. En nuestro ejemplo del peso neonatal, vale 0.446.</p>
<p>El problema de <span class="math inline">\(R^2\)</span> es que su valor siempre aumenta con el número de variables independientes, incluso si las variables que añadimos no sirven para nada. Si, por ejemplo, en la tabla anterior añadiéramos el número de libros que leyó el abuelo del neonato en el año del parto, <span class="math inline">\(R^2\)</span> crecería, pero está claro que añadir al modelo esta nueva variable que no tienen nada que ver con el peso neonatal no puede “mejorarlo”.</p>
<p>Para tener esto en cuenta, para comparar la bondad de modelos con números diferentes de variables independientes en lugar de usar <span class="math inline">\(R^2\)</span> se usa el <strong>coeficiente de determinación corregido</strong> o <strong>ajustado</strong>
<span class="math display">\[
R^2_{\textit{adj}}=1-(1-R^2)\frac{n-1}{n-k-1}
\]</span>
A mayor valor de <span class="math inline">\(R^2_{\textit{adj}}\)</span>, mejor es el modelo.</p>
<p>JAMOVI lo calcula marcando la casilla “R<sup>2</sup> corregida” en <strong>Regresión/Regresión lineal/Ajuste del Modelo</strong>.</p>
<p><img src="INREMDN_files/figure-html/jamoviRLM2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Por ejemplo, si en el modelo lineal del peso neonatal no tenemos en cuenta la edad de la madre, ¿mejora el modelo? Repetimos el cálculo de la regresión lineal múltiple anterior, pero ahora sin la edad de la madre como covariable, y comparamos el <span class="math inline">\(R^2_{\textit{adj}}\)</span> con el anterior:</p>
<p><img src="INREMDN_files/figure-html/jamoviRLM3.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si no tenemos en cuenta la edad de la madre, el <span class="math inline">\(R^2_{\textit{adj}}\)</span> baja de 0.431 a 0.421, por lo que el modelo empeora.</p>
</div>
<div id="intervalos-de-confianza-1" class="section level3 hasAnchor" number="16.2.3">
<h3><span class="header-section-number">16.2.3</span> Intervalos de confianza<a href="regresión-lineal.html#intervalos-de-confianza-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Supongamos ahora que:</p>
<blockquote>
<p>Las variables aleatoria <strong>error</strong>
<span class="math display">\[
E_{i}=(Y|\underline{x}_{i})-(\beta_0+\beta_1 x_{i,1}+\cdots+\beta_k x_{i,k})
\]</span>
tienen todas la misma distribución normal de media 0, y son incorreladas dos a dos.</p>
</blockquote>
<p>En esta caso, como en la regresión simple,</p>
<ul>
<li><p>Para cada <span class="math inline">\(i=0,\ldots,k\)</span>, <span class="math inline">\(b_i\)</span> es un estimador insesgado del correspondiente <span class="math inline">\(\beta_i\)</span></p></li>
<li><p>Entre todos los estimadores insesgados de los <span class="math inline">\(\beta_i\)</span>, los <span class="math inline">\(b_i\)</span> son los más precisos</p></li>
<li><p>Unos ciertos estadísticos relacionados con los <span class="math inline">\(b_i\)</span> tienen distribuciones t de Student conocidas, lo que permite calcular intervalos de confianza para cada <span class="math inline">\(\beta_i\)</span> y para predicciones de <span class="math inline">\(Y\)</span> centrados en sus estimaciones puntuales</p></li>
</ul>
<p>La comprobación de las condiciones para poder calcular estos intervalos de confianza se lleva a cabo con JAMOVI como en el caso simple, en <strong>Regresión/Regresión lineal/Comprobaciones de supuestos</strong>. Ya que estamos, en el caso múltiple, aparte de “Prueba de normalidad” y “Prueba de autocorrelación” nos interesa marcar “Estadísticas de colinealidad”. En el próximo apartado explicaremos por qué.</p>
<p><img src="INREMDN_files/figure-html/jamoviRLM4.png" width="100%" style="display: block; margin: auto;" /></p>
<p>En nuestro ejemplo, los p-valores de las pruebas de normalidad y autocorrelación nos permiten aceptar que las variables aleatorias <span class="math inline">\(E_{i}\)</span> tienen todas la misma distribución normal de media 0, y son incorreladas dos a dos. Por lo tanto tendrá sentido calcular intervalos de confianza.</p>
<p>Los intervalos de confianza para los coeficientes de la regresión lineal se calculan como en el caso simple, marcando la casilla “Intervalo de confianza” en <strong>Regresión/Regresión lineal/Coeficientes del Modelo</strong>:</p>
<p><img src="INREMDN_files/figure-html/jamoviRLM5.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Para cada coeficiente obtenemos su intervalo de confianza y el p-valor del contraste bilateral que lo compara con 0. Así, en nuestro ejemplo estimamos con un 95% de confianza que el coeficiente <span class="math inline">\(\beta_1\)</span> de la edad de la madre está entre 1.03 y 21.34, y en particular que no es 0. En cambio, no podemos rechazar que el coeficiente de la Tensión sistólica media de la madre sea 0.</p>
<p>Por lo que refiere a los intervalos de confianza para las predicciones de la variable dependiente en función de las independientes, se pueden calcular con la función <code>predict</code> en la ventana del editor de R como en el caso simple. Por ejemplo, supongamos que queremos predecir el peso del bebé de una parturienta de 31 años que pesa 72 kg, con nivel de colesterol inicial 182 mg/dl y tendisón sistólica media durante el embarazo 120 si la duración del parto ha sido exactamente 36 semanas.</p>
<ul>
<li>Extraemos vectores con las variables independientes y dependiente de la muestra.</li>
</ul>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="regresión-lineal.html#cb89-1" tabindex="-1"></a>X1<span class="ot">=</span>data<span class="sc">$</span>Edad.Madre</span>
<span id="cb89-2"><a href="regresión-lineal.html#cb89-2" tabindex="-1"></a>X2<span class="ot">=</span>data<span class="sc">$</span>Peso.Madre</span>
<span id="cb89-3"><a href="regresión-lineal.html#cb89-3" tabindex="-1"></a>X3<span class="ot">=</span>data<span class="sc">$</span>Tensión.sistólica.media.madre</span>
<span id="cb89-4"><a href="regresión-lineal.html#cb89-4" tabindex="-1"></a>X4<span class="ot">=</span>data<span class="sc">$</span>Colesterol.total</span>
<span id="cb89-5"><a href="regresión-lineal.html#cb89-5" tabindex="-1"></a>X5<span class="ot">=</span>data<span class="sc">$</span>Edad.Gest.</span>
<span id="cb89-6"><a href="regresión-lineal.html#cb89-6" tabindex="-1"></a>Y<span class="ot">=</span>data<span class="sc">$</span>Peso.neonato</span></code></pre></div>
<ul>
<li>Definimos una tabla de datos con los valores de las variables independientes en nuestro sujeto:</li>
</ul>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="regresión-lineal.html#cb90-1" tabindex="-1"></a>X.nuevas<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">X1=</span><span class="dv">31</span>,<span class="at">X2=</span><span class="dv">72</span>,<span class="at">X3=</span><span class="dv">120</span>,<span class="at">X4=</span><span class="dv">182</span>,<span class="at">X5=</span><span class="dv">36</span>)</span></code></pre></div>
<ul>
<li>Ejecutamos la instrucción</li>
</ul>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="regresión-lineal.html#cb91-1" tabindex="-1"></a><span class="fu">predict</span>(<span class="fu">lm</span>(Y<span class="sc">~</span>X1<span class="sc">+</span>...<span class="sc">+</span>Xk), X.nuevas, <span class="at">interval=</span>...)</span></code></pre></div>
<p>donde <code>X1</code>,…,<code>Xk</code> son los vectores con las variables independientes (en nuestro ejemplo usaríamos <code>X1+X2+X3+X4+X5</code>), <code>Y</code> el vector con la variable dependiente e igualamos <code>interval</code> a <code>"confidence"</code> si queremos el intervalo de confianza del valor esperado de <code>Y</code> o a <code>"prediction"</code> si queremos este intervalo de confianza para un sujeto concreto.</p>
<p>Lo entramos todo en la ventana del editor de R:</p>
<p><img src="INREMDN_files/figure-html/jamoviRLM6.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Hemos obtenido que:</p>
<ul>
<li><p>Nuestra predicción puntual del peso del bebé de nuestra parturienta es de 2.676 kg</p></li>
<li><p>Con un 95% de confianza, estimamos que su peso esperado (es decir, el peso medio de los bebés de las parturientas con los mismos valores de variables independientes que la nuestra) está entre 2.520 y 2.381 kg.</p></li>
<li><p>Con un 95% de confianza, estimamos que el bebé de esta parturienta concreta pesará entre 1.915 y 3.435 gramos.</p></li>
</ul>
</div>
<div id="adecuación-del-modelo" class="section level3 hasAnchor" number="16.2.4">
<h3><span class="header-section-number">16.2.4</span> Adecuación del modelo<a href="regresión-lineal.html#adecuación-del-modelo" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Los p-valores de los contrastes bilaterales <span class="math inline">\(\beta_i=0\)</span> contra <span class="math inline">\(\beta_i\neq 0\)</span> nos permiten estudiar qué coeficientes de la función de regresión podemos rechazar que sean 0. Por ejemplo, en nuestro estudio con un nivel de significación del 5% podemos rechazar que todos los coeficientes de variables independientes (y el término constante) sean 0 salvo el de la Tensión sistólica media de la madre.</p>
<p>Por otro lado, podemos usar las “estadísticas de colinealidad” que obtenemos marcando la casilla correspondiente en <strong>Regresión/Regresión lineal/Comprobaciones de Supuestos</strong> para valorar si alguna variable independiente es función lineal de las otras o no. En concreto, el valor de VIF (<em>Variance Inflation Factor</em>) de una variable es
<span class="math display">\[
\frac{1}{1-R^2_{\text{la variable}}}
\]</span>
donde <span class="math inline">\(R^2_{\text{la variable}}\)</span> indica el <span class="math inline">\(R^2\)</span> de la regresión lineal de esa variable, tomándola como dependiente, respecto de las otras variables independientes. Un valor del VIF muy cercano a 1 indica un <span class="math inline">\(R^2_{\text{la variable}}\)</span> muy cercano a 0 y por lo tanto que esa variable no se aproxima a una combinación lineal del resto. Es el caso de nuestro ejemplo. En cambio, un valor muy grande del VIF significaría un valor muy grandedel <span class="math inline">\(R^2_{\text{la variable}}\)</span> y por lo tanto que esa variable es combinación lineal del resto. En este caso podríamos eliminarla de la regresión, ya que no aporta información nueva en la estimación de la <span class="math inline">\(Y\)</span>.</p>
<p>Volviendo a los p-valores de los contrastes <span class="math inline">\(\beta_i=0\)</span> contra <span class="math inline">\(\beta_i\neq 0\)</span>, si no podemos rechazar que algún <span class="math inline">\(\beta_i\)</span>, con <span class="math inline">\(i=1,\ldots,k\)</span>, sea 0, no podemos concluir que el modelo de regresión lineal tenga sentido: <span class="math inline">\(\beta_1=\cdots=\beta_k=0\)</span>
significaría que el valor esperado de <span class="math inline">\(Y\)</span> en un sujeto no depende de sus valores de <span class="math inline">\(X_1,\ldots,X_k\)</span>.</p>
<p>Pero claro, eso son <span class="math inline">\(k\)</span> contrastes, y ya sabemos que la probabilidad de cometer en alguno un error de tipo I crece con <span class="math inline">\(k\)</span>. Además los contrastes no són independientes, ya que los realizamos todos con la misma muestra, así que ajustar los p-valores no es tan sencillo como multiplicarlos por <span class="math inline">\(k\)</span>.</p>
<p>Una manera de solventar este problema es usar un ANOVA. Si <span class="math inline">\(\beta_1=\beta_2=\cdots=\beta_k=0\)</span>, entonces
<span class="math display">\[
\mu_{Y|\underline{x}_1}=\cdots=\mu_{Y|\underline{x}_k}=\beta_0
\]</span>
Por lo tanto, si en el contraste de <span class="math inline">\(k\)</span> medias
<span class="math display">\[
\left\{\begin{array}{l}
H_0:\mu_{Y|\underline{x}_1}=\cdots=\mu_{Y|\underline{x}_k}\\
H_1:\mbox{no es verdad que } \mu_{Y|\underline{x}_1}=\cdots=\mu_{Y|\underline{x}_k}
\end{array}
\right.
\]</span>
podemos rechazar la hipótesis nula, obtenemos evidencia de que no es verdad que <span class="math inline">\(\beta_1=\beta_2=\cdots=\beta_k=0\)</span> y por lo tanto de que el modelo lineal tiene sentido.</p>
<p>JAMOVI lleva a cabo el ANOVA que resuelve este contraste marcando “Prueba F” en <strong>Regresión/Regresión lineal/Ajuste del Modelo</strong>:</p>
<p><img src="INREMDN_files/figure-html/jamoviRLM7.png" width="100%" style="display: block; margin: auto;" /></p>
<p>El resultado se añade a la tabla “Medidas de ajuste del modelo”. El p-valor del ANOVA da &lt;0.001, por lo que tenemos evidencia de que los pesos esperados dependen de las variables independientes.</p>
<p><strong>AIC y BIC comparando modelos?</strong></p>
</div>
</div>
<div id="regresión-logística" class="section level2 hasAnchor" number="16.3">
<h2><span class="header-section-number">16.3</span> Regresión logística<a href="regresión-lineal.html#regresión-logística" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>







            </section>

          </div>
        </div>
      </div>
<a href="qué-test-usar.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"download": ["pdf", "epub"]
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
